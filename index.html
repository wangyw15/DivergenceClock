<html>

<head>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: black;
        }

        #meter {
            display: flex;
        }

        #meter>img {
            height: 200px;
        }
    </style>
</head>

<body>
    <div id="meter">

    </div>

    <script>
        const meter = document.getElementById("meter");
        const meterSize = 8;

        let intervalNumber = 0;

        function getImageUrl(char) {
            if (char === " ") {
                return `./images/space.png`;
            } else if(char === ".") {
                return `./images/dot.png`;
            } else {
                return `./images/${char}.png`;
            }
        }

        function initMeter() {
            for (let i = 0; i < meterSize; i++) {
                const img = document.createElement("img");
                img.src = getImageUrl(" ");
                meter.appendChild(img);
            }
        }
        
        function setMeterValue(value) {
            for (let i = 0; i < meterSize; i++) {
                const img = meter.children[i];
                const char = value[i];
                if (char === " ") {
                    img.src = getImageUrl(" ");
                } else if(char === ".") {
                    img.src = getImageUrl(".");
                } else {
                    img.src = getImageUrl(char);
                }
            }
        }

        function getTime() {
            const date = new Date();
            const hours = date.getHours().toString().padStart(2, "0");
            const minutes = date.getMinutes().toString().padStart(2, "0");
            const seconds = date.getSeconds().toString().padStart(2, "0");
            return `${hours}.${minutes}.${seconds}`;
        }

        function clock() {
            if (intervalNumber) {
                clearInterval(intervalNumber);
                intervalNumber = 0;
            } else {
                setMeterValue(getTime());
                intervalNumber = setInterval(() => {
                    setMeterValue(getTime());
                }, 1000);
            }
        }

        function divergence() {
            if (intervalNumber) {
                clearInterval(intervalNumber);
                intervalNumber = 0;
            }
            setMeterValue(Math.random().toString().slice(0, 8));
        }

        function onMeterClicked() {
            if (intervalNumber) {
                divergence();
            } else {
                clock();
            }
        }
        
        meter.addEventListener("click", onMeterClicked);

        initMeter();
        clock();
    </script>
</body>

</html>